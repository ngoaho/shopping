!function(o){var e={};function n(t){if(e[t])return e[t].exports;var c=e[t]={i:t,l:!1,exports:{}};return o[t].call(c.exports,c,c.exports,n),c.l=!0,c.exports}n.m=o,n.c=e,n.d=function(o,e,t){n.o(o,e)||Object.defineProperty(o,e,{enumerable:!0,get:t})},n.r=function(o){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},n.t=function(o,e){if(1&e&&(o=n(o)),8&e)return o;if(4&e&&"object"==typeof o&&o&&o.__esModule)return o;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:o}),2&e&&"string"!=typeof o)for(var c in o)n.d(t,c,function(e){return o[e]}.bind(null,c));return t},n.n=function(o){var e=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(e,"a",e),e},n.o=function(o,e){return Object.prototype.hasOwnProperty.call(o,e)},n.p="",n(n.s=9)}({9:function(o,e){jQuery(document).ready((function(o){var e=window.pagenow.length?window.pagenow:"";if(window.typenow.length&&window.typenow,"edit-product"===e){var n=!1;o("input#doaction, input#doaction2").on("click",(function(e){if(n)return!0;e.preventDefault();var t=o(this),c=t.prev("select").val();if("facebook_include"===c){var i=[];o.each(o('input[name="post[]"]:checked'),(function(){i.push(parseInt(o(this).val(),10))})),o.post(facebook_for_woocommerce_products_admin.ajax_url,{action:"facebook_for_woocommerce_set_product_sync_bulk_action_prompt",security:facebook_for_woocommerce_products_admin.set_product_sync_bulk_action_prompt_nonce,toggle:c,products:i},(function(e){e&&!e.success?(closeExistingModal(),new o.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:e.data})):(n=!0,t.trigger("click"))}))}else n=!0,t.trigger("click")}))}if("product"===e){function t(o,e){e.find(".enable-if-sync-enabled").prop("disabled",!o)}function c(o,e){o?(e.find("option[value='sync_and_show']").show(),e.prop("original")&&e.val(e.prop("original"))):(e.find("option[value='sync_and_show']").hide(),"sync_and_show"===e.val()&&e.val("sync_and_hide"))}function i(o,e){var n=e.find("#wc_facebook_commerce_enabled"),t=n.prop("original");n.prop("checked",!!o&&t).prop("disabled",!o),n.trigger("change"),n.prop("original",t),e.find("#product-not-ready-notice, #variable-product-not-ready-notice").hide(),d()&&!r()?e.find("#variable-product-not-ready-notice").show():o||e.find("#product-not-ready-notice").show()}function a(){return!!(d()?r():"sync_disabled"!==g.val())&&!!(d()||(o("#_regular_price").val()||o("#fb_product_price").val()))&&!(!o("#_manage_stock").prop("checked")||!o("#_stock").val())}function r(){var e=o(".js-variable-fb-sync-toggle");return 0===e.length?!!facebook_for_woocommerce_products_admin.is_sync_enabled_for_product:!!e.map((function(e,n){return"sync_disabled"!==o(n).val()?n:null})).length}function d(){var e=o("select#product-type").val();return!(!e||!e.match(/variable/))}function l(o){o.attr("data-original-value",o.val())}function s(e){return e.map((function(e,n){var t=o(n),c=t.val();return!!facebook_for_woocommerce_products_admin.is_product_published&&"sync_disabled"===c&&c!==t.attr("data-original-value")})).toArray().indexOf(!0)>-1}function u(e){return g===e?o("input#post_ID").val():e.closest(".woocommerce_variation").find("input[name^=variable_post_id]").val()}function f(e){closeExistingModal(),m=e,v=u(e),new o.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:{message:facebook_for_woocommerce_products_admin.product_removed_from_sync_confirm_modal_message,buttons:facebook_for_woocommerce_products_admin.product_removed_from_sync_confirm_modal_buttons}})}function _(){o(facebook_for_woocommerce_products_admin.product_removed_from_sync_field_id).val(b.join(","))}function p(o){b=b.filter((function(e){return e!==o})),_()}var m=null,v=null,b=[];o(document.body).on("click","button.button-product-removed-from-sync-delete",(function(){v&&(closeExistingModal(),b.push(v),_())})).on("click","button.button-product-removed-from-sync-cancel",(function(){var o;closeExistingModal(),m&&((o=m).val(o.attr("data-original-value")),m=null),_()})),o("#facebook_options #wc_facebook_commerce_enabled").on("change",(function(){var e=o(this).prop("checked");e?o(".wc_facebook_commerce_fields").show():o(".wc_facebook_commerce_fields").hide(),o(".product_attributes").find(".woocommerce_attribute").length?o(".show_if_has_attributes").show():o(".show_if_has_attributes").hide(),o(this).prop("original",e)})).trigger("change");var g=o("#wc_facebook_sync_mode"),h=g.closest(".woocommerce_options_panel");l(g),g.on("change",(function(){var o,e,n="sync_disabled"!==g.val();t(n,h),o=n,e=h.find(".wc-facebook-commerce-options-group"),o?e.show():e.hide(),n&&p(u(g)),g.prop("original",g.val()),s(g)&&f(g)})).trigger("change"),o("#_virtual").on("change",(function(){c(!o(this).prop("checked"),g)})).trigger("change"),o("input[name=_visibility]").on("change",(function(){"hidden"!==o(this).val()&&"search"!==o(this).val()&&"sync_disabled"===g.val()&&g.val("sync_and_show").trigger("change")}));var w=o("#woocommerce-product-data");w.on("change","#_regular_price, #_manage_stock, #_stock, #wc_facebook_sync_mode, #fb_product_price",(function(e){setTimeout((function(){i(a(),o("#facebook_options"))}),1)})),o(".woocommerce_variations").on("change",".js-variable-fb-sync-toggle",(function(){var e=o(this),n="sync_disabled"!==e.val();t(n,e.closest(".wc-metabox-content")),i(a(),o("#facebook_options")),n&&p(u(e)),e.prop("original",e.val()),s(e)&&f(e)})),w.on("woocommerce_variations_loaded",(function(){w.find(".js-variable-fb-sync-toggle").each((function(e,n){var c=o(n);t("sync_disabled"!==c.val(),c.closest(".wc-metabox-content")),c.prop("original",c.val()),l(c)})),o(".variable_is_virtual").on("change",(function(){var e=o(this).closest(".wc-metabox-content").find(".js-variable-fb-sync-toggle");c(!o(this).prop("checked"),e)})),i(a(),o("#facebook_options"))})),w.on("change",".js-fb-product-image-source",(function(){var e=o(this).closest(".woocommerce_options_panel, .wc-metabox-content"),n=o(this).val();e.find(".product-image-source-field").closest(".form-field").hide(),e.find(".show-if-product-image-source-".concat(n)).closest(".form-field").show()})),o(".js-fb-product-image-source:checked").trigger("change"),w.on("woocommerce_variations_loaded",(function(){o(".js-variable-fb-sync-toggle:visible").trigger("change"),o(".js-fb-product-image-source:checked").trigger("change"),o(".variable_is_virtual:visible").trigger("change")})),o("#facebook_options").on("click","#product-not-ready-notice-open-modal",(function(e){e.preventDefault(),closeExistingModal(),new o.WCBackboneModal.View({target:"facebook-for-woocommerce-modal",string:{message:facebook_for_woocommerce_products_admin.product_not_ready_modal_message,buttons:facebook_for_woocommerce_products_admin.product_not_ready_modal_buttons}})})),i(a(),h);var y,k=o("#open_media_library"),j=o("#fb_product_video_selected_thumbnails"),x=o("#fb_product_video"),M=x.val()?x.val().split(",").map(Number):[];function O(){x.val(M.join(","))}function S(o,e){M=M.filter((function(e){return e!==o})),O(),e.remove()}k.on("click",(function(e){e.preventDefault(),y||((y=wp.media({title:"Select videos",button:{text:"Save"},library:{type:"video"},multiple:!0})).on("open",(function(){var o=y.state().get("selection");M.forEach((function(e){var n=wp.media.attachment(e);n.fetch(),o.add(n?[n]:[])}))})),y.on("select",(function(){var e,n,t,c;e=y.state().get("selection"),n=e.map((function(o){return o.id})),t=M.filter((function(o){return!n.includes(o)})),c=n.filter((function(o){return!M.includes(o)})),j.find(".form-field").each((function(){var e=o(this),n=parseInt(e.find("span").data("attachment-id"),10);t.includes(n)&&S(n,e)})),e.each((function(e){if(e=e.toJSON(),c.includes(e.id)&&e.mime&&e.mime.startsWith("video/")){var n=function(e){var n=o("<p>",{class:"form-field video-thumbnail"}),t=o("<img>",{src:e.icon}),c=o("<span>",{text:e.url,"data-attachment-id":e.id}),i=o("<a>",{href:"#",text:"Remove",class:"remove-video"});return i.on("click",(function(o){o.preventDefault(),S(e.id,n)})),n.append(t,c,i),n}(e);j.append(n),M.push(e.id)}else e.mime.startsWith("video/")||alert("Please select a valid video file.")})),O()}))),y.open()})),j.on("click",".remove-video",(function(e){e.preventDefault();var n=o(this);S(n.data("attachment-id"),n.closest(".form-field"))}))}}))}});